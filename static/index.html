<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BookUniverse Pro</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
  </head>
  <body>
    <button
      type="button"
      class="menu-toggle"
      onclick="handleSidebarToggle()"
      aria-label="Toggle Menu"
    >
      <i class="bx bx-menu" id="sidebar-icon"></i>
    </button>

    <button
      type="button"
      class="theme-toggle"
      onclick="toggleDarkMode()"
      aria-label="Toggle Theme"
    >
      <i class="bx bxs-moon" id="theme-icon-main"></i>
    </button>

    <div class="mobile-overlay" onclick="handleSidebarToggle()"></div>

    <div class="modal-overlay" id="auth-modal">
      <div class="auth-box">
        <div
          style="
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
          "
        >
          <div class="tab-btn active" onclick="switchTab('login')">Login</div>
          <div class="tab-btn" onclick="switchTab('signup')">Sign Up</div>
        </div>

        <form id="login-form" onsubmit="handleLogin(event)">
          <h2 class="auth-header">Welcome Back</h2>
          <input
            type="email"
            id="login-email"
            class="auth-input"
            placeholder="Email Address"
            required
          />
          <input
            type="password"
            id="login-pass"
            class="auth-input"
            placeholder="Password"
            required
          />
          <p
            style="
              font-size: 0.8rem;
              text-align: right;
              margin-bottom: 10px;
              cursor: pointer;
              color: var(--primary);
            "
            onclick="switchTab('reset')"
          >
            Forgot Password?
          </p>
          <button type="submit" class="auth-btn">Login</button>
        </form>

        <form
          id="signup-form"
          onsubmit="handleSignup(event)"
          style="display: none"
        >
          <h2 class="auth-header">Create Account</h2>
          <input
            type="text"
            id="signup-name"
            class="auth-input"
            placeholder="Full Name"
            required
          />
          <input
            type="text"
            id="signup-user"
            class="auth-input"
            placeholder="Username"
            required
          />
          <input
            type="email"
            id="signup-email"
            class="auth-input"
            placeholder="Email Address"
            required
          />
          <input
            type="password"
            id="signup-pass"
            class="auth-input"
            placeholder="Password"
            required
          />
          <button type="submit" class="auth-btn">Create Account</button>
        </form>

        <form
          id="reset-form"
          onsubmit="handleResetRequest(event)"
          style="display: none"
        >
          <h2 class="auth-header">Reset Password</h2>
          <p style="font-size: 0.8rem; color: #666; margin-bottom: 15px">
            Enter your email to receive a reset link.
          </p>
          <input
            type="email"
            id="reset-email"
            class="auth-input"
            placeholder="Your Email"
            required
          />
          <button type="submit" class="auth-btn">Send Reset Link</button>
          <p
            style="margin-top: 10px; font-size: 0.8rem; cursor: pointer"
            onclick="switchTab('login')"
          >
            Back to Login
          </p>
        </form>
      </div>
    </div>

    <div class="modal-overlay" id="settings-modal">
      <div class="auth-box">
        <i class="bx bx-x close-icon" onclick="toggleSettings()"></i>
        <h3>Settings</h3>
        <p>Update your credentials</p>
        <br />
        <form onsubmit="changePassword(event)">
          <input
            type="password"
            id="new-pass"
            class="auth-input"
            placeholder="New Password"
            required
          />
          <button type="submit" class="auth-btn">Update Password</button>
        </form>
      </div>
    </div>

    <div class="modal-overlay" id="ai-modal">
      <div class="auth-box" style="width: 500px; text-align: left">
        <i
          class="bx bx-x close-icon"
          onclick="document.getElementById('ai-modal').classList.remove('open')"
        ></i>
        <h2
          style="display: flex; align-items: center; gap: 10px; color: #6c5ce7"
        >
          <i class="bx bxs-bot"></i> AI Librarian
        </h2>
        <hr style="border: 0; height: 1px; background: #eee; margin: 15px 0" />

        <div id="ai-content" style="line-height: 1.6; color: #444">
          Thinking... <i class="bx bx-loader-alt bx-spin"></i>
        </div>

        <button
          class="auth-btn"
          style="margin-top: 20px"
          onclick="document.getElementById('ai-modal').classList.remove('open')"
        >
          Awesome!
        </button>
      </div>
    </div>

    <div class="modal-overlay" id="form-modal">
      <div class="auth-box" style="width: 400px">
        <i class="bx bx-x close-icon" onclick="toggleAddModal()"></i>
        <h3 id="form-title">ðŸ“– Add New Book</h3>
        <br />

        <div
          id="interactive"
          class="viewport"
          style="
            display: none;
            width: 100%;
            height: 200px;
            background: #000;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
            border-radius: 8px;
          "
        >
          <video
            autoplay="true"
            preload="auto"
            src=""
            muted="true"
            playsinline="true"
            style="width: 100%; height: 100%; object-fit: cover"
          ></video>
          <button
            type="button"
            onclick="stopScanner()"
            style="
              position: absolute;
              top: 10px;
              right: 10px;
              background: rgba(0, 0, 0, 0.5);
              color: white;
              border: none;
              padding: 5px 10px;
              border-radius: 4px;
              cursor: pointer;
            "
          >
            Stop
          </button>
        </div>

        <button
          type="button"
          onclick="startScanner()"
          class="auth-btn"
          style="
            background: #6c5ce7;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
          "
        >
          <i class="bx bx-barcode-reader"></i> Scan ISBN Barcode
        </button>

        <div
          style="
            width: 100%;
            height: 1px;
            background: #eee;
            margin-bottom: 15px;
          "
        ></div>

        <input type="hidden" id="book-id" />
        <div style="position: relative; margin-bottom: 15px">
          <input
            type="text"
            id="name"
            class="auth-input"
            placeholder="Book Title (e.g. Dune)"
            style="margin-bottom: 0; padding-right: 50px"
          />

          <button
            type="button"
            onclick="magicFill()"
            title="Auto-fill details with AI"
            style="
              position: absolute;
              right: 10px;
              top: 50%;
              transform: translateY(-50%);
              background: none;
              border: none;
              color: #6c5ce7;
              font-size: 1.2rem;
              cursor: pointer;
            "
          >
            <i class="bx bxs-magic-wand"></i>
          </button>
        </div>

        <input
          type="text"
          id="author"
          class="auth-input"
          placeholder="Author Name"
        />
        <input
          type="text"
          id="pub"
          class="auth-input"
          placeholder="Publisher"
        />
        <select
          id="status"
          class="auth-input"
          style="cursor: pointer"
          aria-label="Book Status"
        >
          <option value="To Read">ðŸ”µ To Read</option>
          <option value="Reading">ðŸŸ¡ Currently Reading</option>
          <option value="Completed">ðŸŸ¢ Completed</option>
        </select>

        <button class="auth-btn" onclick="handleFormSubmit()">Save Book</button>
      </div>
    </div>

    <div class="app-container">
      <nav class="sidebar" id="sidebar">
        <div>
          <div class="brand">
            <i class="bx bxs-book-heart"></i>
            <span>BookUniverse</span>
          </div>
          <ul class="nav-links">
            <li
              class="nav-item active"
              id="nav-library"
              onclick="showAllBooks()"
            >
              <i class="bx bxs-dashboard"></i>
              <span>Library</span>
            </li>
            <li class="nav-item" onclick="toggleAddModal()">
              <i class="bx bxs-plus-circle"></i>
              <span>Add Book</span>
            </li>
            <li class="nav-item" id="nav-fav" onclick="filterFavorites()">
              <i class="bx bxs-heart"></i>
              <span>Favorites</span>
            </li>
            <li class="nav-item" onclick="toggleSettings()">
              <i class="bx bxs-cog"></i>
              <span>Settings</span>
            </li>
            <li class="nav-item" onclick="copyProfileLink()">
              <i class="bx bx-share-alt"></i>
              <span>Share Profile</span>
            </li>
            <li class="nav-item" onclick="getAIRecommendations()">
              <i class="bx bxs-magic-wand" style="color: #a29bfe"></i>
              <span
                style="
                  background: linear-gradient(45deg, #6c5ce7, #ff7675);
                  -webkit-background-clip: text;
                  -webkit-text-fill-color: transparent;
                  font-weight: bold;
                "
                >AI Suggest</span
              >
            </li>
          </ul>
        </div>

        <div class="user-profile" id="user-profile">
          <div class="user-avatar" id="user-avatar">U</div>
          <div class="user-info">
            <h4 id="user-name">User</h4>
            <p id="user-email">...</p>
          </div>
          <i
            class="bx bx-log-out"
            style="margin-left: auto; color: #ff7675"
            onclick="handleLogout()"
            title="Logout"
          ></i>
        </div>
      </nav>

      <main class="main-content">
        <div class="search-container" style="position: relative">
          <input
            type="text"
            id="search-box"
            placeholder="ðŸ” Search or say 'Show me...'"
            onkeyup="filterBooks()"
          />

          <button
            id="voice-btn"
            onclick="startVoiceSearch()"
            title="Voice Search"
            aria-label="Start Voice Search"
          >
            <i class="bx bxs-microphone"></i>
          </button>
        </div>
        <div id="book-grid" class="book-grid"></div>
      </main>
    </div>

    <div id="toast" class="toast">Action Successful!</div>

    <script src="js/script.js"></script>
  </body>
</html>
